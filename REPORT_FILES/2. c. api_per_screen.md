# API Usage Per Screen - Bank Saving System

## ðŸ“± Screen to API Mapping

Dokumentasi ini menjelaskan API endpoints mana yang digunakan oleh setiap screen dalam aplikasi mobile.

---

## ðŸ“Š Summary Table

| Screen | API Endpoints Used | Purpose |
|--------|-------------------|---------|
| Customer List | `GET /api/customers` | Load customer list |
| Customer Form (Create) | `POST /api/customers` | Create new customer |
| Customer Form (Edit) | `GET /api/customers/:id`<br>`PUT /api/customers/:id` | Load & update customer |
| Deposito Type List | `GET /api/deposito-types` | Load deposito types |
| Deposito Type Form (Create) | `POST /api/deposito-types` | Create deposito type |
| Deposito Type Form (Edit) | `GET /api/deposito-types/:id`<br>`PUT /api/deposito-types/:id` | Load & update type |
| Account List | `GET /api/accounts`<br>`GET /api/customers`<br>`GET /api/deposito-types` | Load accounts & related data |
| Account Form (Create) | `GET /api/customers`<br>`GET /api/deposito-types`<br>`POST /api/accounts` | Load options & create account |
| Account Detail | `GET /api/accounts/:id`<br>`GET /api/transactions?account_id=:id` | Load account & transactions |
| Transaction Form (Deposit) | `GET /api/accounts`<br>`POST /api/transactions/deposit` | Select account & process deposit |
| Transaction Form (Withdrawal) | `GET /api/accounts`<br>`POST /api/transactions/withdrawal` | Select account & process withdrawal |
| Transaction History | `GET /api/transactions` | Load all transactions |

---

## ðŸ“‹ Detailed Screen Documentation

### 1. Customer List Screen

**Path:** `src/screens/Customer/CustomerListScreen.tsx`

**API Calls:**

#### On Mount / Pull to Refresh
```typescript
GET /api/customers
```
**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "name": "John Doe",
      "created_at": "2025-12-01T10:00:00Z",
      "updated_at": "2025-12-01T10:00:00Z"
    }
  ]
}
```

**Redux Action:** `fetchCustomers()`

---

### 2. Customer Form Screen (Create/Edit)

**Path:** `src/screens/Customer/CustomerFormScreen.tsx`

**API Calls:**

#### On Mount (Edit Mode)
```typescript
GET /api/customers/:id
```

#### On Save (Create Mode)
```typescript
POST /api/customers
Body: { "name": "John Doe" }
```

#### On Save (Edit Mode)
```typescript
PUT /api/customers/:id
Body: { "name": "John Doe Updated" }
```

**Redux Actions:** 
- `fetchCustomerById(id)`
- `createCustomer(data)`
- `updateCustomer(id, data)`

---

### 3. Deposito Type List Screen

**Path:** `src/screens/DepositoType/DepositoTypeListScreen.tsx`

**API Calls:**

#### On Mount / Pull to Refresh
```typescript
GET /api/deposito-types
```
**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "name": "Gold Deposito",
      "yearly_return": 0.05,
      "created_at": "2025-12-01T10:00:00Z",
      "updated_at": "2025-12-01T10:00:00Z"
    }
  ]
}
```

**Redux Action:** `fetchDepositoTypes()`

---

### 4. Deposito Type Form Screen (Create/Edit)

**Path:** `src/screens/DepositoType/DepositoTypeFormScreen.tsx`

**API Calls:**

#### On Mount (Edit Mode)
```typescript
GET /api/deposito-types/:id
```

#### On Save (Create Mode)
```typescript
POST /api/deposito-types
Body: {
  "name": "Platinum Deposito",
  "yearly_return": 0.08
}
```

#### On Save (Edit Mode)
```typescript
PUT /api/deposito-types/:id
Body: {
  "name": "Platinum Deposito Updated",
  "yearly_return": 0.085
}
```

**Redux Actions:**
- `fetchDepositoTypeById(id)`
- `createDepositoType(data)`
- `updateDepositoType(id, data)`

---

### 5. Account List Screen

**Path:** `src/screens/Account/AccountListScreen.tsx`

**API Calls:**

#### On Mount / Pull to Refresh
```typescript
GET /api/accounts
GET /api/customers       // For displaying customer names
GET /api/deposito-types  // For displaying deposito type names
```

**Response (Accounts):**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "customer_id": "uuid",
      "deposito_type_id": "uuid",
      "balance": 1500000,
      "created_at": "2025-12-01T10:00:00Z",
      "updated_at": "2025-12-01T10:00:00Z"
    }
  ]
}
```

**Redux Actions:**
- `fetchAccounts()`
- `fetchCustomers()`
- `fetchDepositoTypes()`

---

### 6. Account Form Screen (Create)

**Path:** `src/screens/Account/AccountFormScreen.tsx`

**API Calls:**

#### On Mount
```typescript
GET /api/customers       // Load customer options
GET /api/deposito-types  // Load deposito type options
```

#### On Save
```typescript
POST /api/accounts
Body: {
  "customer_id": "uuid",
  "deposito_type_id": "uuid",
  "initial_balance": 1000000
}
```

**Redux Actions:**
- `fetchCustomers()`
- `fetchDepositoTypes()`
- `createAccount(data)`

---

### 7. Account Detail Screen

**Path:** `src/screens/Account/AccountDetailScreen.tsx`

**API Calls:**

#### On Mount / Pull to Refresh
```typescript
GET /api/accounts/:id
GET /api/transactions?account_id=:id
```

**Response (Account with Details):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "customer_id": "uuid",
    "deposito_type_id": "uuid",
    "balance": 1500000,
    "created_at": "2025-12-01T10:00:00Z",
    "updated_at": "2025-12-01T10:00:00Z",
    "customer": {
      "id": "uuid",
      "name": "John Doe"
    },
    "deposito_type": {
      "id": "uuid",
      "name": "Gold Deposito",
      "yearly_return": 0.05
    }
  }
}
```

**Redux Actions:**
- `fetchAccountById(id)`
- `fetchTransactions(accountId)`

---

### 8. Transaction Form (Deposit) Screen

**Path:** `src/screens/Transaction/TransactionFormScreen.tsx` (mode: deposit)

**API Calls:**

#### On Mount
```typescript
GET /api/accounts  // Load account options
```

#### On Save
```typescript
POST /api/transactions/deposit
Body: {
  "account_id": "uuid",
  "amount": 500000,
  "transaction_date": "2025-12-03T10:00:00Z"
}
```

**Redux Actions:**
- `fetchAccounts()`
- `processDeposit(data)`

---

### 9. Transaction Form (Withdrawal) Screen

**Path:** `src/screens/Transaction/TransactionFormScreen.tsx` (mode: withdrawal)

**API Calls:**

#### On Mount
```typescript
GET /api/accounts  // Load account options
```

#### On Save
```typescript
POST /api/transactions/withdrawal
Body: {
  "account_id": "uuid",
  "amount": 300000,
  "transaction_date": "2025-12-03T10:00:00Z"
}
```

**Response (with Interest):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "account_id": "uuid",
    "type": "withdrawal",
    "amount": 300000,
    "transaction_date": "2025-12-03T10:00:00Z",
    "balance_before": 1500000,
    "balance_after": 1225000,
    "interest_earned": 25000,
    "months_held": 4,
    "created_at": "2025-12-03T10:00:00Z"
  }
}
```

**Redux Actions:**
- `fetchAccounts()`
- `processWithdrawal(data)`

---

### 10. Transaction History Screen

**Path:** `src/screens/Transaction/TransactionHistoryScreen.tsx`

**API Calls:**

#### On Mount / Pull to Refresh
```typescript
GET /api/transactions
```

#### With Filter (By Account)
```typescript
GET /api/transactions?account_id=:id
```

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "account_id": "uuid",
      "type": "deposit",
      "amount": 500000,
      "transaction_date": "2025-12-01T10:00:00Z",
      "balance_before": 1000000,
      "balance_after": 1500000,
      "interest_earned": null,
      "months_held": null,
      "created_at": "2025-12-01T10:00:00Z"
    }
  ]
}
```

**Redux Actions:**
- `fetchTransactions(accountId?)`

---

## ðŸ”„ Common Patterns

### Loading State Pattern
All screens follow this pattern:
```typescript
useEffect(() => {
  dispatch(fetchData());
}, []);
```

### Pull to Refresh Pattern
```typescript
const onRefresh = () => {
  dispatch(fetchData());
};
```

### Form Submission Pattern
```typescript
const handleSubmit = () => {
  if (isEditMode) {
    dispatch(updateData(id, formData));
  } else {
    dispatch(createData(formData));
  }
};
```

---

## ðŸ“Š API Call Frequency

### High Frequency (Every Screen Visit)
- `GET /api/customers`
- `GET /api/deposito-types`
- `GET /api/accounts`
- `GET /api/transactions`

### Medium Frequency (Form Screens)
- `POST /api/customers`
- `POST /api/accounts`
- `POST /api/transactions/deposit`
- `POST /api/transactions/withdrawal`

### Low Frequency (Edit Operations)
- `PUT /api/customers/:id`
- `PUT /api/deposito-types/:id`
- `DELETE /api/customers/:id`
- `DELETE /api/accounts/:id`

---

## âœ… Coverage Summary

**Total Screens:** 10  
**Total Unique API Endpoints Used:** 17

- **Customer Endpoints:** 5 (GET all, GET one, POST, PUT, DELETE)
- **Deposito Type Endpoints:** 5 (GET all, GET one, POST, PUT, DELETE)
- **Account Endpoints:** 4 (GET all, GET one, POST, DELETE)
- **Transaction Endpoints:** 3 (GET all, POST deposit, POST withdrawal)

All screens properly integrated with Redux Saga for async API calls and state management.
